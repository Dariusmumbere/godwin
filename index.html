<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Goodness and Mercy | YouTube Player</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #f0f0f0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 20px;
            width: 100%;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: #fff;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: #aaa;
            margin-bottom: 30px;
        }
        
        .player-container {
            background-color: #0d1117;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            margin-bottom: 30px;
            overflow: hidden;
            position: relative;
        }
        
        .video-wrapper {
            position: relative;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            height: 0;
            overflow: hidden;
            border-radius: 10px;
            background-color: #000;
        }
        
        .video-wrapper iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .video-placeholder {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            color: white;
            z-index: 10;
        }
        
        .video-placeholder.hidden {
            display: none;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            border-top-color: #ff0000;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }
        
        .controls {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid #333;
        }
        
        .btn {
            background-color: #ff0000;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(255, 0, 0, 0.3);
        }
        
        .btn:hover {
            background-color: #cc0000;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(255, 0, 0, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background-color: #333;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
        
        .btn-secondary:hover {
            background-color: #444;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
        }
        
        .btn i {
            font-size: 1.2rem;
        }
        
        .status-panel {
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            display: none;
        }
        
        .status-panel.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .status-title {
            font-size: 1.3rem;
            margin-bottom: 15px;
            color: #ff9900;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-list {
            list-style-type: none;
        }
        
        .status-list li {
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
        }
        
        .status-list li:last-child {
            border-bottom: none;
        }
        
        .status-value {
            font-weight: 600;
            color: #4CAF50;
        }
        
        .status-value.error {
            color: #ff4444;
        }
        
        .video-info {
            background-color: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .video-info h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #ff9900;
        }
        
        .video-info p {
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .stats {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 15px;
        }
        
        .stat {
            display: flex;
            flex-direction: column;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #ff0000;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
        }
        
        footer {
            margin-top: 40px;
            text-align: center;
            color: #777;
            font-size: 0.9rem;
            padding: 20px;
            width: 100%;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }
            
            .player-container {
                padding: 15px;
            }
            
            .controls {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                width: 100%;
                justify-content: center;
            }
        }
        
        .notification {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #4CAF50;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.5s ease;
        }
        
        .notification.show {
            transform: translateY(0);
            opacity: 1;
        }
        
        .notification.error {
            background-color: #ff4444;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Goodness and Mercy</h1>
            <div class="subtitle">Pastor Wilson Bugembe | KingsPorch Studios | YouTube Video Player</div>
        </header>
        
        <main>
            <div class="player-container">
                <div class="video-wrapper">
                    <!-- Video placeholder that shows while loading -->
                    <div class="video-placeholder" id="videoPlaceholder">
                        <div class="loading-spinner"></div>
                        <h2>Loading YouTube Player...</h2>
                        <p>Preparing video playback for "Goodness and Mercy"</p>
                    </div>
                    
                    <!-- YouTube iframe will be inserted here by JavaScript -->
                    <div id="player"></div>
                </div>
                
                <div class="controls">
                    <button class="btn" id="playBtn">
                        <i class="fas fa-play"></i> Play Video
                    </button>
                    <button class="btn btn-secondary" id="pauseBtn">
                        <i class="fas fa-pause"></i> Pause Video
                    </button>
                    <button class="btn btn-secondary" id="restartBtn">
                        <i class="fas fa-redo"></i> Restart Video
                    </button>
                    <button class="btn btn-secondary" id="showStatusBtn">
                        <i class="fas fa-info-circle"></i> Show Player Status
                    </button>
                </div>
                
                <div class="status-panel" id="statusPanel">
                    <h3 class="status-title"><i class="fas fa-chart-bar"></i> Player Status & Diagnostics</h3>
                    <ul class="status-list" id="statusList">
                        <!-- Status items will be added here by JavaScript -->
                    </ul>
                </div>
            </div>
            
            <div class="video-info">
                <h3>About This Video</h3>
                <p>This player is configured to play "Goodness and Mercy" by Pastor Wilson Bugembe from KingsPorch Studios. The video is loaded directly from YouTube using their official embed API with multiple fallback methods to ensure reliable playback.</p>
                <p>If the video doesn't play automatically, use the Play Video button above. The player includes diagnostic tools to troubleshoot any playback issues.</p>
                
                <div class="stats">
                    <div class="stat">
                        <span class="stat-value" id="viewCount">32K</span>
                        <span class="stat-label">Views</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value">1</span>
                        <span class="stat-label">Month Ago</span>
                    </div>
                    <div class="stat">
                        <span class="stat-value">YouTube</span>
                        <span class="stat-label">Source</span>
                    </div>
                </div>
            </div>
        </main>
        
        <footer>
            <p>YouTube Video Player &copy; 2026 | Designed for robust playback of "Goodness and Mercy"</p>
            <p>Video by Pastor Wilson Bugembe | KingsPorch Studios</p>
        </footer>
    </div>
    
    <!-- Notification element -->
    <div class="notification" id="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notificationMessage">Video is playing successfully!</span>
    </div>

    <script>
        // Video configuration
        const VIDEO_ID = 'qd6cxzri_UY';
        const VIDEO_URL = `https://www.youtube.com/watch?v=${VIDEO_ID}`;
        
        // DOM elements
        const videoPlaceholder = document.getElementById('videoPlaceholder');
        const playBtn = document.getElementById('playBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const restartBtn = document.getElementById('restartBtn');
        const showStatusBtn = document.getElementById('showStatusBtn');
        const statusPanel = document.getElementById('statusPanel');
        const statusList = document.getElementById('statusList');
        const notification = document.getElementById('notification');
        const notificationMessage = document.getElementById('notificationMessage');
        
        // Global player variable
        let player;
        let playerInitialized = false;
        let fallbackAttempted = false;
        
        // Show notification function
        function showNotification(message, isError = false) {
            notificationMessage.textContent = message;
            notification.className = 'notification';
            
            if (isError) {
                notification.classList.add('error');
                notification.querySelector('i').className = 'fas fa-exclamation-triangle';
            } else {
                notification.querySelector('i').className = 'fas fa-check-circle';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }
        
        // Update status panel
        function updateStatus() {
            statusList.innerHTML = '';
            
            const statusItems = [
                { label: 'Player API Loaded', value: window.YT ? 'Yes' : 'No' },
                { label: 'Player Initialized', value: playerInitialized ? 'Yes' : 'No' },
                { label: 'YouTube Iframe Ready', value: player ? 'Yes' : 'No' },
                { label: 'Fallback Attempted', value: fallbackAttempted ? 'Yes' : 'No' },
                { label: 'Current Time', value: player ? formatTime(player.getCurrentTime()) : 'N/A' },
                { label: 'Video Duration', value: player ? formatTime(player.getDuration()) : 'N/A' },
                { label: 'Video ID', value: VIDEO_ID },
                { label: 'Browser Online', value: navigator.onLine ? 'Yes' : 'No' }
            ];
            
            statusItems.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `<span>${item.label}:</span> <span class="status-value ${item.value === 'No' ? 'error' : ''}">${item.value}</span>`;
                statusList.appendChild(li);
            });
        }
        
        // Format time in seconds to MM:SS
        function formatTime(seconds) {
            if (!seconds || isNaN(seconds)) return '0:00';
            
            const mins = Math.floor(seconds / 60);
            const secs = Math.floor(seconds % 60);
            return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
        }
        
        // Initialize YouTube Player
        function initYouTubePlayer() {
            // Check if YouTube API is already loaded
            if (!window.YT) {
                loadYouTubeAPI();
                return;
            }
            
            createPlayer();
        }
        
        // Load YouTube IFrame API
        function loadYouTubeAPI() {
            // Check if script is already being loaded
            if (document.querySelector('script[src*="youtube.com/iframe_api"]')) {
                // Script is already loading, wait for it
                setTimeout(createPlayer, 1000);
                return;
            }
            
            const tag = document.createElement('script');
            tag.src = 'https://www.youtube.com/iframe_api';
            tag.async = true;
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
            
            // Setup global callback for when API is ready
            window.onYouTubeIframeAPIReady = function() {
                console.log('YouTube IFrame API ready');
                createPlayer();
            };
            
            // Fallback in case API doesn't load
            setTimeout(() => {
                if (!window.YT) {
                    console.warn('YouTube API failed to load, trying fallback');
                    attemptFallback();
                }
            }, 5000);
        }
        
        // Create the YouTube player
        function createPlayer() {
            // Check if player already exists
            if (playerInitialized) {
                console.log('Player already initialized');
                return;
            }
            
            // Check if YT object is available
            if (!window.YT) {
                console.error('YouTube API not available, attempting fallback');
                attemptFallback();
                return;
            }
            
            try {
                player = new YT.Player('player', {
                    videoId: VIDEO_ID,
                    playerVars: {
                        'autoplay': 1,
                        'controls': 1,
                        'rel': 0,
                        'modestbranding': 1,
                        'playsinline': 1
                    },
                    events: {
                        'onReady': onPlayerReady,
                        'onStateChange': onPlayerStateChange,
                        'onError': onPlayerError
                    }
                });
                
                playerInitialized = true;
                console.log('YouTube player created successfully');
            } catch (error) {
                console.error('Error creating YouTube player:', error);
                attemptFallback();
            }
        }
        
        // Fallback method using direct iframe embed
        function attemptFallback() {
            if (fallbackAttempted) return;
            
            fallbackAttempted = true;
            console.log('Attempting fallback player...');
            
            // Hide the placeholder
            videoPlaceholder.classList.add('hidden');
            
            // Create a simple iframe as fallback
            const playerDiv = document.getElementById('player');
            playerDiv.innerHTML = `
                <iframe 
                    width="100%" 
                    height="100%" 
                    src="https://www.youtube.com/embed/${VIDEO_ID}?autoplay=1&controls=1&rel=0&modestbranding=1&playsinline=1" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                    allowfullscreen
                    style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"
                ></iframe>
            `;
            
            showNotification('Using fallback player - video should play now', false);
            updateStatus();
        }
        
        // When player is ready
        function onPlayerReady(event) {
            console.log('YouTube player is ready');
            videoPlaceholder.classList.add('hidden');
            
            // Try to play the video
            setTimeout(() => {
                try {
                    event.target.playVideo();
                    showNotification('Video is playing successfully!', false);
                } catch (error) {
                    console.warn('Autoplay blocked, waiting for user interaction:', error);
                    showNotification('Click "Play Video" to start playback', true);
                }
            }, 1000);
            
            updateStatus();
        }
        
        // When player state changes
        function onPlayerStateChange(event) {
            const states = {
                '-1': 'unstarted',
                '0': 'ended',
                '1': 'playing',
                '2': 'paused',
                '3': 'buffering',
                '5': 'video cued'
            };
            
            console.log('Player state changed:', states[event.data] || event.data);
            
            // If video ended, restart it
            if (event.data === YT.PlayerState.ENDED) {
                setTimeout(() => {
                    player.playVideo();
                }, 2000);
            }
            
            updateStatus();
        }
        
        // When player error occurs
        function onPlayerError(event) {
            console.error('YouTube player error:', event.data);
            showNotification('Player error occurred, trying fallback method', true);
            
            // Try fallback on error
            if (!fallbackAttempted) {
                setTimeout(attemptFallback, 2000);
            }
            
            updateStatus();
        }
        
        // Play video function
        function playVideo() {
            if (player && typeof player.playVideo === 'function') {
                try {
                    player.playVideo();
                    showNotification('Video playing', false);
                } catch (error) {
                    console.error('Error playing video:', error);
                    showNotification('Error playing video, trying fallback', true);
                    attemptFallback();
                }
            } else {
                console.warn('Player not ready, attempting fallback');
                attemptFallback();
            }
            
            updateStatus();
        }
        
        // Pause video function
        function pauseVideo() {
            if (player && typeof player.pauseVideo === 'function') {
                try {
                    player.pauseVideo();
                    showNotification('Video paused', false);
                } catch (error) {
                    console.error('Error pausing video:', error);
                }
            }
            
            updateStatus();
        }
        
        // Restart video function
        function restartVideo() {
            if (player && typeof player.seekTo === 'function') {
                try {
                    player.seekTo(0);
                    player.playVideo();
                    showNotification('Video restarted', false);
                } catch (error) {
                    console.error('Error restarting video:', error);
                }
            } else {
                // Fallback: reload the iframe
                const playerDiv = document.getElementById('player');
                playerDiv.innerHTML = '';
                playerInitialized = false;
                fallbackAttempted = false;
                initYouTubePlayer();
            }
            
            updateStatus();
        }
        
        // Event listeners for buttons
        playBtn.addEventListener('click', playVideo);
        pauseBtn.addEventListener('click', pauseVideo);
        restartBtn.addEventListener('click', restartVideo);
        
        showStatusBtn.addEventListener('click', function() {
            updateStatus();
            statusPanel.classList.toggle('active');
            this.innerHTML = statusPanel.classList.contains('active') 
                ? '<i class="fas fa-times-circle"></i> Hide Status' 
                : '<i class="fas fa-info-circle"></i> Show Player Status';
        });
        
        // Initialize player when page loads
        document.addEventListener('DOMContentLoaded', initYouTubePlayer);
        
        // Also try to initialize if page becomes visible (for mobile/tab switching)
        document.addEventListener('visibilitychange', function() {
            if (!document.hidden && !playerInitialized && !fallbackAttempted) {
                console.log('Page visible again, reinitializing player');
                initYouTubePlayer();
            }
        });
        
        // Update status periodically when panel is visible
        setInterval(() => {
            if (statusPanel.classList.contains('active')) {
                updateStatus();
            }
        }, 2000);
    </script>
</body>
</html>
